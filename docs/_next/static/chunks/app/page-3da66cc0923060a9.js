(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5986:(e,t,a)=>{"use strict";a.d(t,{N:()=>l,R:()=>o});var s=a(95155),r=a(12115),n=a(70115);let i=(0,r.createContext)(void 0);function l(e){let{children:t}=e,[a,r]=(0,n.M)("habitlocal_gemini_api_key",null),l=null!==a&&""!==a.trim();return(0,s.jsx)(i.Provider,{value:{apiKey:a,setApiKey:r,isApiKeySet:l},children:t})}function o(){let e=(0,r.useContext)(i);if(void 0===e)throw Error("useApiKey must be used within an ApiKeyProvider");return e}},9131:(e,t,a)=>{"use strict";a.d(t,{L:()=>c,a:()=>d});var s=a(95155),r=a(12115),n=a(70115),i=a(19226);let l=(0,r.createContext)(void 0),o=["hsl(var(--chart-1))","hsl(var(--chart-2))","hsl(var(--chart-3))","hsl(var(--chart-4))","hsl(var(--chart-5))","hsl(250, 60%, 60%)","hsl(300, 60%, 60%)","hsl(350, 60%, 60%)"];function d(e){let{children:t}=e,[a,d]=(0,n.M)("habitlocal_habits",[]),c=(0,r.useCallback)(e=>{let t={...e,id:crypto.randomUUID(),createdAt:new Date().toISOString(),archived:!1,progress:{},color:o[a.length%o.length]};d(e=>[...e,t])},[d,a.length]),m=(0,r.useCallback)((e,t)=>{d(a=>a.map(a=>a.id===e?{...a,...t}:a))},[d]),u=(0,r.useCallback)(e=>{d(t=>t.filter(t=>t.id!==e))},[d]),h=(0,r.useCallback)((e,t)=>{d(a=>a.map(a=>a.id===e?{...a,archived:t}:a))},[d]),f=(0,r.useCallback)((e,t)=>{let a=(0,i.GP)(t,"yyyy-MM-dd");d(t=>t.map(t=>{if(t.id===e){let e={...t.progress};return e[a]=!e[a],{...t,progress:e}}return t}))},[d]),g=(0,r.useCallback)(e=>a.find(t=>t.id===e),[a]),x=(0,r.useCallback)(()=>a.filter(e=>!e.archived),[a]),p=(0,r.useCallback)(e=>{let t=a.find(t=>t.id===e);if(!t)return 0;let s=0,r=new Date;for(r.setHours(0,0,0,0);;){let e=(0,i.GP)(r,"yyyy-MM-dd");if(t.progress[e])s++,r.setDate(r.getDate()-1);else if(0===s&&(0,i.GP)(r,"yyyy-MM-dd")===(0,i.GP)(new Date,"yyyy-MM-dd")){r.setDate(r.getDate()-1);let e=(0,i.GP)(r,"yyyy-MM-dd");if(t.progress[e]);else break}else break}return s},[a]);return(0,s.jsx)(l.Provider,{value:{habits:a,addHabit:c,updateHabit:m,deleteHabit:u,archiveHabit:h,toggleHabitProgress:f,getHabitById:g,getTodaysHabits:x,getStreak:p},children:t})}function c(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useHabits must be used within a HabitProvider");return e}},32751:(e,t,a)=>{Promise.resolve().then(a.bind(a,67551))},52612:(e,t,a)=>{"use strict";a.d(t,{D:()=>l,N:()=>i});var s=a(95155),r=a(12115);let n=r.createContext({theme:"system",setTheme:()=>null});function i(e){let{children:t,defaultTheme:a="system",storageKey:i="vite-ui-theme",attribute:l="class",enableSystem:o=!0,...d}=e,[c,m]=r.useState(()=>localStorage.getItem(i)||a),[u,h]=r.useState();return r.useEffect(()=>{let e=window.document.documentElement,t=t=>{e.classList.remove("light","dark"),"class"===l?e.classList.add(t):e.setAttribute(l,t),h(t)},a=c;if("system"===c&&o){let e=window.matchMedia("(prefers-color-scheme: dark)");t(e.matches?"dark":"light");let a=()=>{t(e.matches?"dark":"light")};return e.addEventListener("change",a),()=>e.removeEventListener("change",a)}t(c)},[c,o,l]),(0,s.jsx)(n.Provider,{...d,value:{theme:c,setTheme:e=>{localStorage.setItem(i,e),m(e)},resolvedTheme:u},children:t})}let l=()=>{let e=r.useContext(n);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},59434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var s=a(52596),r=a(39688);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},67551:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>tA});var s=a(95155),r=a(12115),n=a(99708),i=a(74466),l=a(59434);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:a,variant:r,size:i,asChild:d=!1,...c}=e,m=d?n.DX:"button";return(0,s.jsx)(m,{className:(0,l.cn)(o({variant:r,size:i,className:a})),ref:t,...c})});d.displayName="Button";var c=a(34301),m=a(62177),u=a(90221),h=a(55594);let f=r.forwardRef((e,t)=>{let{className:a,type:r,...n}=e;return(0,s.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...n})});f.displayName="Input";let g=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});g.displayName="Textarea";var x=a(40968);let p=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),y=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(x.b,{ref:t,className:(0,l.cn)(p(),a),...r})});y.displayName=x.b.displayName;var b=a(15452),v=a(25318);let j=b.bL;b.l9;let N=b.ZL,w=b.bm,k=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(b.hJ,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});k.displayName=b.hJ.displayName;let A=r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,s.jsxs)(N,{children:[(0,s.jsx)(k,{}),(0,s.jsxs)(b.UC,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...n,children:[r,(0,s.jsxs)(b.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(v.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});A.displayName=b.UC.displayName;let C=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};C.displayName="DialogHeader";let I=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};I.displayName="DialogFooter";let S=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(b.hE,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});S.displayName=b.hE.displayName;let E=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(b.VY,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})});E.displayName=b.VY.displayName;var P=a(9131),R=a(87481);let T=h.Ik({name:h.Yj().min(1,"Name is required").max(100),description:h.Yj().max(500).optional()});function D(e){let{isOpen:t,setIsOpen:a,habitToEdit:n,onFormSubmit:i}=e,{addHabit:l,updateHabit:o}=(0,P.L)(),{toast:c}=(0,R.dj)(),{control:h,handleSubmit:x,reset:p,formState:{errors:b}}=(0,m.mN)({resolver:(0,u.u)(T),defaultValues:{name:"",description:""}});return(0,r.useEffect)(()=>{n?p({name:n.name,description:n.description||""}):p({name:"",description:""})},[n,p,t]),(0,s.jsx)(j,{open:t,onOpenChange:a,children:(0,s.jsxs)(A,{className:"sm:max-w-[480px] glass-card",children:[(0,s.jsxs)(C,{children:[(0,s.jsx)(S,{className:"font-headline text-2xl",children:n?"Edit Habit":"Add New Habit"}),(0,s.jsx)(E,{children:n?"Update the details of your habit.":"Define a new habit you want to track."})]}),(0,s.jsxs)("form",{onSubmit:x(e=>{n?(o(n.id,e),c({title:"Habit Updated",description:'"'.concat(e.name,'" has been updated.')})):(l(e),c({title:"Habit Added",description:'"'.concat(e.name,'" has been added.')})),i&&i(),a(!1)}),className:"grid gap-6 py-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(y,{htmlFor:"name",children:"Habit Name"}),(0,s.jsx)(m.xI,{name:"name",control:h,render:e=>{let{field:t}=e;return(0,s.jsx)(f,{id:"name",placeholder:"e.g., Morning Run",...t})}}),b.name&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:b.name.message})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(y,{htmlFor:"description",children:"Description (Optional)"}),(0,s.jsx)(m.xI,{name:"description",control:h,render:e=>{let{field:t}=e;return(0,s.jsx)(g,{id:"description",placeholder:"e.g., Run for 30 minutes",...t})}}),b.description&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:b.description.message})]}),(0,s.jsxs)(I,{children:[(0,s.jsx)(w,{asChild:!0,children:(0,s.jsx)(d,{type:"button",variant:"outline",children:"Cancel"})}),(0,s.jsx)(d,{type:"submit",children:n?"Save Changes":"Add Habit"})]})]})]})})}let H=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});H.displayName="Card";let M=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",a),...r})});M.displayName="CardHeader";let O=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});O.displayName="CardTitle";let _=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})});_.displayName="CardDescription";let L=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",a),...r})});L.displayName="CardContent";let G=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",a),...r})});G.displayName="CardFooter";var Y=a(67820),F=a(10518);let z=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(Y.bL,{ref:t,className:(0,l.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...r,children:(0,s.jsx)(Y.C1,{className:(0,l.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(F.A,{className:"h-4 w-4"})})})});z.displayName=Y.bL.displayName;var K=a(21992),U=a(73158),J=a(70154);let q=K.bL,B=K.l9;K.YJ,K.ZL,K.Pb,K.z6,r.forwardRef((e,t)=>{let{className:a,inset:r,children:n,...i}=e;return(0,s.jsxs)(K.ZP,{ref:t,className:(0,l.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",a),...i,children:[n,(0,s.jsx)(U.A,{className:"ml-auto"})]})}).displayName=K.ZP.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(K.G5,{ref:t,className:(0,l.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}).displayName=K.G5.displayName;let V=r.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...n}=e;return(0,s.jsx)(K.ZL,{children:(0,s.jsx)(K.UC,{ref:t,sideOffset:r,className:(0,l.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})})});V.displayName=K.UC.displayName;let Z=r.forwardRef((e,t)=>{let{className:a,inset:r,...n}=e;return(0,s.jsx)(K.q7,{ref:t,className:(0,l.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",a),...n})});Z.displayName=K.q7.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,checked:n,...i}=e;return(0,s.jsxs)(K.H_,{ref:t,className:(0,l.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:n,...i,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(K.VF,{children:(0,s.jsx)(F.A,{className:"h-4 w-4"})})}),r]})}).displayName=K.H_.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,s.jsxs)(K.hN,{ref:t,className:(0,l.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(K.VF,{children:(0,s.jsx)(J.A,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=K.hN.displayName,r.forwardRef((e,t)=>{let{className:a,inset:r,...n}=e;return(0,s.jsx)(K.JU,{ref:t,className:(0,l.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",a),...n})}).displayName=K.JU.displayName;let Q=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(K.wv,{ref:t,className:(0,l.cn)("-mx-1 my-1 h-px bg-muted",a),...r})});Q.displayName=K.wv.displayName;var X=a(89829),W=a(38350),$=a(15222),ee=a(12191),et=a(65064),ea=a(17569),es=a(77223),er=a(19226),en=a(83343),ei=a(17649);let el=ei.bL;ei.l9;let eo=ei.ZL,ed=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(ei.hJ,{className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});ed.displayName=ei.hJ.displayName;let ec=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)(eo,{children:[(0,s.jsx)(ed,{}),(0,s.jsx)(ei.UC,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]})});ec.displayName=ei.UC.displayName;let em=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};em.displayName="AlertDialogHeader";let eu=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};eu.displayName="AlertDialogFooter";let eh=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(ei.hE,{ref:t,className:(0,l.cn)("text-lg font-semibold",a),...r})});eh.displayName=ei.hE.displayName;let ef=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(ei.VY,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})});ef.displayName=ei.VY.displayName;let eg=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(ei.rc,{ref:t,className:(0,l.cn)(o(),a),...r})});eg.displayName=ei.rc.displayName;let ex=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(ei.ZD,{ref:t,className:(0,l.cn)(o({variant:"outline"}),"mt-2 sm:mt-0",a),...r})});ex.displayName=ei.ZD.displayName;var ep=a(50172),ey=a(31949),eb=a(74601),ev=a(5986),ej=a(38851);let eN="habitlocal_gemini_api_key";async function ew(e){let t=window.localStorage.getItem(eN);if(!t)throw console.error("Missing Gemini API key in localStorage (key: "+eN+")"),Error("Missing Gemini API key. Please set it in the app settings.");let a=new ej.GoogleGenerativeAI(t).getGenerativeModel({model:"gemini-1.5-flash-latest",safetySettings:[{category:ej.DE.HARM_CATEGORY_HARASSMENT,threshold:ej.vk.BLOCK_MEDIUM_AND_ABOVE},{category:ej.DE.HARM_CATEGORY_HATE_SPEECH,threshold:ej.vk.BLOCK_MEDIUM_AND_ABOVE},{category:ej.DE.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:ej.vk.BLOCK_MEDIUM_AND_ABOVE},{category:ej.DE.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:ej.vk.BLOCK_MEDIUM_AND_ABOVE}]});try{return(await a.generateContent(e)).response.text()}catch(e){if(console.error("Error calling Gemini API:",e),e instanceof Error&&e.message.includes("API key not valid"))throw Error("Invalid Gemini API key. Please check and update your key in settings.");throw Error("Failed to get response from AI. Ensure your API key is valid and has quota.")}}let ek=h.Ik({recommendations:h.YO(h.Yj().describe("A list of personalized strategies for improving habit consistency.")).describe("Personalized habit improvement strategies based on user progress data.")});function eA(e){let{isOpen:t,setIsOpen:a,habit:n}=e,[i,l]=(0,r.useState)([]),[o,c]=(0,r.useState)(!1),[m,u]=(0,r.useState)(null),{isApiKeySet:h}=(0,ev.R)(),{toast:f}=(0,R.dj)();(0,r.useEffect)(()=>{t&&n&&h?g():t&&!h?(u("API Key is not set. Please configure it in settings to get AI recommendations."),c(!1)):t&&!n&&(u("No habit selected for recommendations."),c(!1)),t||(l([]),u(null),c(!1))},[t,n,h]);let g=async()=>{if(n){c(!0),u(null),l([]);try{var e;let t;let a=JSON.stringify(n.progress),s="Improve consistency for habit: ".concat(n.name,". ").concat(n.description||""),r=(e={habitName:n.name,progressData:a,userGoals:s},"You are an AI assistant designed to provide personalized recommendations for improving habit consistency.\n\nAnalyze the user's habit progress data and goals, and suggest strategies to help them improve.\n\nHabit Name: \"".concat(e.habitName,'"\nProgress Data (JSON format, dates and completion status): ').concat(e.progressData,'\nUser Goals: "').concat(e.userGoals,'"\n\nBased on this information, provide a list of 2-4 personalized, actionable strategies that the user can implement to improve their consistency and achieve their goals.\nOutput ONLY a valid JSON object in the format below. Do NOT include any other text or markdown formatting like ```json:\n{\n  "recommendations": ["strategy 1", "strategy 2", "strategy 3"]\n}\n')),i=await ew(r);try{t=JSON.parse(i)}catch(e){throw console.error("Failed to parse JSON response from AI for recommendations:",e,"Raw response:",i),Error("AI returned an invalid format for recommendations. Please try again.")}let o=ek.safeParse(t);if(!o.success)throw console.error("Zod validation failed for recommendations:",o.error.errors,"Parsed data:",t),Error("AI returned data in an unexpected structure for recommendations.");l(o.data.recommendations)}catch(t){console.error("Error fetching recommendations:",t);let e=t.message||"Failed to generate recommendations. Please check your API key and try again.";u(e),f({title:"AI Error",description:e,variant:"destructive"})}finally{c(!1)}}};return(0,s.jsx)(j,{open:t,onOpenChange:a,children:(0,s.jsxs)(A,{className:"sm:max-w-lg glass-card",children:[(0,s.jsxs)(C,{children:[(0,s.jsxs)(S,{className:"font-headline text-2xl flex items-center",children:[(0,s.jsx)(ea.A,{className:"mr-2 h-6 w-6 text-primary"}),'AI Strategies for "',null==n?void 0:n.name,'"']}),(0,s.jsx)(E,{children:"Personalized tips to help you improve this habit."})]}),(0,s.jsxs)("div",{className:"py-4 max-h-[60vh] overflow-y-auto",children:[o&&(0,s.jsxs)("div",{className:"flex items-center justify-center p-6",children:[(0,s.jsx)(ep.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-3",children:"Generating insights..."})]}),m&&!o&&(0,s.jsxs)("div",{className:"flex items-center text-destructive p-4 bg-destructive/10 rounded-md",children:[(0,s.jsx)(ey.A,{className:"h-5 w-5 mr-2 shrink-0"}),(0,s.jsx)("p",{children:m})]}),!o&&!m&&i.length>0&&(0,s.jsx)("ul",{className:"space-y-3 list-disc list-inside text-sm",children:i.map((e,t)=>(0,s.jsx)("li",{className:"leading-relaxed",children:e},t))}),!o&&!m&&0===i.length&&h&&n&&(0,s.jsx)("p",{className:"text-muted-foreground p-4 text-center",children:"No specific recommendations available at this moment. Keep tracking your progress!"})]}),(0,s.jsxs)(I,{className:"flex-col sm:flex-row gap-2",children:[h&&n&&!m&&(0,s.jsxs)(d,{onClick:g,disabled:o,variant:"outline",className:"w-full sm:w-auto",children:[o?(0,s.jsx)(ep.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(eb.A,{className:"mr-2 h-4 w-4"}),"Refresh Strategies"]}),(0,s.jsx)(d,{onClick:()=>a(!1),className:"w-full sm:w-auto",children:"Close"})]})]})})}function eC(e){let{habit:t}=e,{toggleHabitProgress:a,deleteHabit:n,archiveHabit:i,getStreak:l}=(0,P.L)(),[o,c]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1),[h,f]=(0,r.useState)(!1),{toast:g}=(0,R.dj)(),x=new Date,p=(0,er.GP)(x,"yyyy-MM-dd"),y=t.progress[p]||!1,b=(0,r.useMemo)(()=>l(t.id),[t.progress,t.id,l]),v=t.color?{borderLeft:"5px solid ".concat(t.color)}:{};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(H,{className:"w-full transition-all duration-300 ease-in-out glass-card ".concat(t.archived?"opacity-60":""),style:v,children:[(0,s.jsx)(M,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(O,{className:"font-headline text-xl flex items-center",children:[t.name,b>0&&(0,s.jsxs)("span",{className:"ml-2 text-sm font-medium text-orange-500 bg-orange-100 dark:bg-orange-900 dark:text-orange-400 px-2 py-0.5 rounded-full flex items-center",children:[(0,s.jsx)(X.A,{className:"h-3 w-3 mr-1"})," ",b," Day",b>1?"s":""]})]}),t.description&&(0,s.jsx)(_,{className:"mt-1",children:t.description})]}),(0,s.jsxs)(q,{children:[(0,s.jsx)(B,{asChild:!0,children:(0,s.jsx)(d,{variant:"ghost",size:"icon",className:"shrink-0",children:(0,s.jsx)(W.A,{className:"h-5 w-5"})})}),(0,s.jsxs)(V,{align:"end",children:[(0,s.jsxs)(Z,{onClick:()=>c(!0),children:[(0,s.jsx)($.A,{className:"mr-2 h-4 w-4"})," Edit"]}),(0,s.jsxs)(Z,{onClick:()=>{i(t.id,!t.archived),g({title:"Habit ".concat(t.archived?"Restored":"Archived"),description:'"'.concat(t.name,'" has been ').concat(t.archived?"restored":"archived",".")})},children:[t.archived?(0,s.jsx)(ee.A,{className:"mr-2 h-4 w-4"}):(0,s.jsx)(et.A,{className:"mr-2 h-4 w-4"}),t.archived?"Restore":"Archive"]}),(0,s.jsxs)(Z,{onClick:()=>f(!0),children:[(0,s.jsx)(ea.A,{className:"mr-2 h-4 w-4"})," Get Insights"]}),(0,s.jsx)(Q,{}),(0,s.jsxs)(Z,{onClick:()=>u(!0),className:"text-destructive focus:text-destructive focus:bg-destructive/10",children:[(0,s.jsx)(es.A,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})]})}),(0,s.jsxs)(L,{className:"pb-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(z,{id:"complete-".concat(t.id),checked:y,onCheckedChange:()=>{a(t.id,x)},disabled:t.archived,"aria-label":"Mark ".concat(t.name," as ").concat(y?"incomplete":"complete"," for today")}),(0,s.jsx)("label",{htmlFor:"complete-".concat(t.id),className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:y?"Completed Today!":"Mark as complete for today"})]}),b>2&&!y&&(0,s.jsxs)("p",{className:"text-xs text-amber-600 dark:text-amber-400 mt-2 animate-pulse",children:["Streak Saver: Keep your ",b,"-day streak going!"]})]}),(0,s.jsxs)(G,{className:"text-xs text-muted-foreground",children:["Created: ",(0,er.GP)((0,en.H)(t.createdAt),"MMM d, yyyy")]})]}),(0,s.jsx)(D,{isOpen:o,setIsOpen:c,habitToEdit:t}),(0,s.jsx)(el,{open:m,onOpenChange:u,children:(0,s.jsxs)(ec,{children:[(0,s.jsxs)(em,{children:[(0,s.jsx)(eh,{children:"Are you sure?"}),(0,s.jsxs)(ef,{children:['This action cannot be undone. This will permanently delete the habit "',t.name,'" and all its progress.']})]}),(0,s.jsxs)(eu,{children:[(0,s.jsx)(ex,{children:"Cancel"}),(0,s.jsx)(eg,{onClick:()=>{n(t.id),g({title:"Habit Deleted",description:'"'.concat(t.name,'" has been deleted.'),variant:"destructive"}),u(!1)},className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})}),(0,s.jsx)(eA,{isOpen:h,setIsOpen:f,habit:t})]})}var eI=a(60960);function eS(e){let{showArchived:t=!1}=e,{habits:a}=(0,P.L)(),r=a.filter(e=>t?e.archived:!e.archived);return 0===r.length?(0,s.jsxs)("div",{className:"text-center py-10",children:[(0,s.jsx)(eI.A,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,s.jsx)("h3",{className:"mt-2 text-lg font-medium text-foreground font-headline",children:t?"No Archived Habits":"No Habits Yet"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:t?"You haven't archived any habits.":"Get started by adding a new habit!"})]}):(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:r.map(e=>(0,s.jsx)(eC,{habit:e},e.id))})}var eE=a(17832);let eP=h.Ik({name:h.Yj().describe("The name of the habit."),description:h.Yj().describe("A short description of the habit."),frequency:h.Yj().describe("The frequency of the habit (e.g., daily, weekly, specific days)."),time:h.Yj().optional().describe("The time of day for the habit, if applicable.")});function eR(){let[e,t]=(0,r.useState)(""),[a,n]=(0,r.useState)(!1),{addHabit:i}=(0,P.L)(),{isApiKeySet:l}=(0,ev.R)(),{toast:o}=(0,R.dj)(),c=async a=>{if(a.preventDefault(),e.trim()){if(!l){o({title:"API Key Required",description:"Please set your Gemini API key in settings to use AI features.",variant:"destructive"});return}n(!0);try{let a;let s='You are a helpful assistant that converts natural language sentences into structured habit definitions.\n\nGiven the following sentence: "'.concat({sentence:e}.sentence,'"\n\nPlease extract the following information and output ONLY a valid JSON object in the format below. Do NOT include any other text or markdown formatting like ```json:\n{\n  "name": "string",\n  "description": "string",\n  "frequency": "string",\n  "time": "string (optional)"\n}\n\nExample:\nSentence: "Run 3 km Tue/Thu"\nOutput:\n{\n  "name": "Run 3 km",\n  "description": "Run 3 kilometers every Tuesday and Thursday",\n  "frequency": "Tue/Thu"\n}\n\nSentence: "Read a book for 20 minutes every evening"\nOutput:\n{\n  "name": "Read a book",\n  "description": "Read a book for 20 minutes",\n  "frequency": "every evening",\n  "time": "evening"\n}\n'),r=await ew(s);try{a=JSON.parse(r)}catch(e){throw console.error("Failed to parse JSON response from AI for NLP:",e,"Raw response:",r),Error("AI returned an invalid format for habit creation. Please try rephrasing.")}let n=eP.safeParse(a);if(!n.success)throw console.error("Zod validation failed for NLP:",n.error.errors,"Parsed data:",a),Error("AI returned data in an unexpected structure for habit creation.");let l=n.data;i({name:l.name,description:"".concat(l.description," (Frequency: ").concat(l.frequency).concat(l.time?", Time: "+l.time:"",")")}),o({title:"Habit Created with AI!",description:'"'.concat(l.name,'" was added to your habits.')}),t("")}catch(e){console.error("Error creating habit with AI:",e),o({title:"AI Error",description:e.message||"Could not process habit creation. Check your API key and try again.",variant:"destructive"})}finally{n(!1)}}};return(0,s.jsxs)(H,{className:"mb-8 glass-card",children:[(0,s.jsxs)(M,{children:[(0,s.jsxs)(O,{className:"font-headline text-xl flex items-center",children:[(0,s.jsx)(eE.A,{className:"mr-2 h-5 w-5 text-primary"}),"Create Habit with AI"]}),(0,s.jsx)(_,{children:'Type a sentence like "Run 3 km Tue/Thu" or "Read a book for 20 minutes every evening".'})]}),(0,s.jsxs)(L,{children:[(0,s.jsxs)("form",{onSubmit:c,className:"flex flex-col sm:flex-row items-start gap-3",children:[(0,s.jsx)(f,{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"e.g., Meditate for 10 minutes daily",className:"flex-grow",disabled:a||!l}),(0,s.jsxs)(d,{type:"submit",disabled:a||!e.trim()||!l,className:"w-full sm:w-auto",children:[a?(0,s.jsx)(ep.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(eE.A,{className:"mr-2 h-4 w-4"}),"Create Habit"]})]}),!l&&(0,s.jsx)("p",{className:"mt-2 text-xs text-destructive",children:"Set your Gemini API key in settings to enable this feature."})]})]})}var eT=a(25299),eD=a(58527),eH=a(9041),eM=a(83540),eO=a(94517),e_=a(24026);let eL={light:"",dark:".dark"},eG=r.createContext(null);function eY(){let e=r.useContext(eG);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}let eF=r.forwardRef((e,t)=>{let{id:a,className:n,children:i,config:o,...d}=e,c=r.useId(),m="chart-".concat(a||c.replace(/:/g,""));return(0,s.jsx)(eG.Provider,{value:{config:o},children:(0,s.jsxs)("div",{"data-chart":m,ref:t,className:(0,l.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",n),...d,children:[(0,s.jsx)(ez,{id:m,config:o}),(0,s.jsx)(eM.u,{children:i})]})})});eF.displayName="Chart";let ez=e=>{let{id:t,config:a}=e,r=Object.entries(a).filter(e=>{let[,t]=e;return t.theme||t.color});return r.length?(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(eL).map(e=>{let[a,s]=e;return"\n".concat(s," [data-chart=").concat(t,"] {\n").concat(r.map(e=>{var t;let[s,r]=e,n=(null===(t=r.theme)||void 0===t?void 0:t[a])||r.color;return n?"  --color-".concat(s,": ").concat(n,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},eK=eO.m,eU=r.forwardRef((e,t)=>{let{active:a,payload:n,className:i,indicator:o="dot",hideLabel:d=!1,hideIndicator:c=!1,label:m,labelFormatter:u,labelClassName:h,formatter:f,color:g,nameKey:x,labelKey:p}=e,{config:y}=eY(),b=r.useMemo(()=>{var e;if(d||!(null==n?void 0:n.length))return null;let[t]=n,a="".concat(p||t.dataKey||t.name||"value"),r=eB(y,t,a),i=p||"string"!=typeof m?null==r?void 0:r.label:(null===(e=y[m])||void 0===e?void 0:e.label)||m;return u?(0,s.jsx)("div",{className:(0,l.cn)("font-medium",h),children:u(i,n)}):i?(0,s.jsx)("div",{className:(0,l.cn)("font-medium",h),children:i}):null},[m,u,n,d,h,y,p]);if(!a||!(null==n?void 0:n.length))return null;let v=1===n.length&&"dot"!==o;return(0,s.jsxs)("div",{ref:t,className:(0,l.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",i),children:[v?null:b,(0,s.jsx)("div",{className:"grid gap-1.5",children:n.map((e,t)=>{let a="".concat(x||e.name||e.dataKey||"value"),r=eB(y,e,a),n=g||e.payload.fill||e.color;return(0,s.jsx)("div",{className:(0,l.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===o&&"items-center"),children:f&&(null==e?void 0:e.value)!==void 0&&e.name?f(e.value,e.name,e,t,e.payload):(0,s.jsxs)(s.Fragment,{children:[(null==r?void 0:r.icon)?(0,s.jsx)(r.icon,{}):!c&&(0,s.jsx)("div",{className:(0,l.cn)("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===o,"w-1":"line"===o,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===o,"my-0.5":v&&"dashed"===o}),style:{"--color-bg":n,"--color-border":n}}),(0,s.jsxs)("div",{className:(0,l.cn)("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[(0,s.jsxs)("div",{className:"grid gap-1.5",children:[v?b:null,(0,s.jsx)("span",{className:"text-muted-foreground",children:(null==r?void 0:r.label)||e.name})]}),e.value&&(0,s.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})});eU.displayName="ChartTooltip";let eJ=e_.s,eq=r.forwardRef((e,t)=>{let{className:a,hideIcon:r=!1,payload:n,verticalAlign:i="bottom",nameKey:o}=e,{config:d}=eY();return(null==n?void 0:n.length)?(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center justify-center gap-4","top"===i?"pb-3":"pt-3",a),children:n.map(e=>{let t="".concat(o||e.dataKey||"value"),a=eB(d,e,t);return(0,s.jsxs)("div",{className:(0,l.cn)("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[(null==a?void 0:a.icon)&&!r?(0,s.jsx)(a.icon,{}):(0,s.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),null==a?void 0:a.label]},e.value)})}):null});function eB(e,t,a){if("object"!=typeof t||null===t)return;let s="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,r=a;return a in t&&"string"==typeof t[a]?r=t[a]:s&&a in s&&"string"==typeof s[a]&&(r=s[a]),r in e?e[r]:e[a]}eq.displayName="ChartLegend";var eV=a(99445),eZ=a(94754),eQ=a(96025),eX=a(16238),eW=a(62341),e$=a(8782),e0=a(34e3),e1=a(54811),e2=a(43554),e5=a(7860),e4=a(73503),e3=a(67554),e8=a(24386);let e6=h.Ik({insight:h.Yj().describe("A concise (1-2 sentences), actionable, and encouraging insight based on the provided stats. Example: \"Your dedication is showing with an improving trend in completing your {activeHabitCount} habits! Keep up the great work on '{highestPerformingHabit.name}'. Maybe give '{lowestPerformingHabit.name}' a little extra focus this week?\"")});function e9(){let[e,t]=(0,r.useState)(null),[a,n]=(0,r.useState)(!1),[i,l]=(0,r.useState)(null),{isApiKeySet:o}=(0,ev.R)(),{habits:c}=(0,P.L)(),{toast:m}=(0,R.dj)(),u=(0,r.useMemo)(()=>c.filter(e=>!e.archived),[c]),h=(0,r.useMemo)(()=>{let e;if(0===u.length)return null;let t=new Date,a=(0,e2.e)(t,13),s=(0,e5.k)({start:a,end:t}).map(e=>{let t=(0,er.GP)(e,"yyyy-MM-dd"),a=0;return u.forEach(e=>{e.progress[t]&&a++}),{date:t,rate:u.length>0?a/u.length*100:0}}),r="stable";if(s.length>=14){let t=s.slice(7).map(e=>e.rate),a=s.slice(0,7).map(e=>e.rate),n=t.reduce((e,t)=>e+t,0)/(t.length||1),i=a.reduce((e,t)=>e+t,0)/(a.length||1);e=parseFloat(n.toFixed(1)),n>i+5?r="improving":n<i-5&&(r="declining")}else if(s.length>=7){let t=s.map(e=>e.rate);e=parseFloat((t.reduce((e,t)=>e+t,0)/(t.length||1)).toFixed(1))}let n=u.map(e=>{let a=Object.entries(e.progress).filter(e=>{let[a]=e,s=(0,en.H)(a);return 30>=(0,e8.c)(t,s)}),s=a.filter(e=>{let[,t]=e;return t}).length,r=a.length>0?a.length:Math.min(30,(0,e8.c)(t,(0,en.H)(e.createdAt))+1);return{name:e.name,rate:r>0?parseFloat((s/r*100).toFixed(1)):0}}).sort((e,t)=>e.rate-t.rate);return{overallCompletionTrend:r,lowestPerformingHabit:n.length>0&&n[0].rate<100?n[0]:void 0,highestPerformingHabit:n.length>0?n[n.length-1]:void 0,activeHabitCount:u.length,averageCompletionRateLast7Days:e}},[u]),f=async()=>{if(!o){m({title:"API Key Required",description:"Please set your Gemini API key for AI insights.",variant:"destructive"});return}if(!h){m({title:"Not Enough Data",description:"Track some habits to get AI insights on your stats."});return}n(!0),l(null),t(null);try{var e,a,s,r;let n,i;let l=(e={overallCompletionTrend:h.overallCompletionTrend,lowestPerformingHabit:h.lowestPerformingHabit,highestPerformingHabit:h.highestPerformingHabit,activeHabitCount:h.activeHabitCount,averageCompletionRateLast7Days:h.averageCompletionRateLast7Days},i="You are an encouraging and insightful AI habit coach.\nThe user is tracking ".concat(e.activeHabitCount," habits.\nTheir overall completion trend is: ").concat(e.overallCompletionTrend,".\n"),void 0!==e.averageCompletionRateLast7Days&&(i+="Their average completion rate in the last 7 days was ".concat(e.averageCompletionRateLast7Days,"%.\n")),e.highestPerformingHabit&&(i+="Their best performing habit is '".concat(e.highestPerformingHabit.name,"' with ").concat(e.highestPerformingHabit.rate,"% success.\n")),e.lowestPerformingHabit?i+="Their habit needing more attention is '".concat(e.lowestPerformingHabit.name,"' with ").concat(e.lowestPerformingHabit.rate,"% success.\n"):i+="All habits are doing well!\n",i+='\nBased on this, provide a concise (1-2 sentences), actionable, and encouraging insight.\nIf there\'s a lowest performing habit, gently suggest focusing on it. If all habits are doing well, celebrate that.\nBe positive and motivational.\n\nOutput ONLY a valid JSON object in the format below. Do NOT include any other text or markdown formatting like ```json:\n{\n  "insight": "string"\n}\n\nExample if lowest performing habit exists:\n{\n  "insight": "Your dedication is showing with an '.concat(e.overallCompletionTrend," trend in completing your ").concat(e.activeHabitCount," habits! Keep up the great work, especially on '").concat((null===(a=e.highestPerformingHabit)||void 0===a?void 0:a.name)||"your habits","'. Maybe give '").concat((null===(s=e.lowestPerformingHabit)||void 0===s?void 0:s.name)||"some habits",'\' a little extra focus this week?"\n}\nExample if no lowest performing habit:\n{\n  "insight": "Fantastic work maintaining a ').concat(e.overallCompletionTrend," trend across your ").concat(e.activeHabitCount," habits! You're doing great with '").concat((null===(r=e.highestPerformingHabit)||void 0===r?void 0:r.name)||"your habits","' and all your other habits are on track too!\"\n}\n")),o=await ew(l);try{n=JSON.parse(o)}catch(e){throw console.error("Failed to parse JSON response from AI for stats insight:",e,"Raw response:",o),Error("AI returned an invalid format for stats insight. Please try again.")}let d=e6.safeParse(n);if(!d.success)throw console.error("Zod validation failed for stats insight:",d.error.errors,"Parsed data:",n),Error("AI returned data in an unexpected structure for stats insight.");t(d.data.insight)}catch(t){console.error("Error fetching stats insight:",t);let e=t.message||"Failed to generate insight. Please check your API key and try again.";l(e),m({title:"AI Error",description:e,variant:"destructive"})}finally{n(!1)}};return((0,r.useEffect)(()=>{o&&u.length},[o,u.length,h]),0!==u.length||o)?(0,s.jsxs)(H,{className:"glass-card",children:[(0,s.jsxs)(M,{children:[(0,s.jsxs)(O,{className:"font-headline text-xl flex items-center",children:[(0,s.jsx)(e4.A,{className:"mr-2 h-5 w-5 text-primary"}),"AI Stats Insight"]}),(0,s.jsx)(_,{children:"A quick AI-powered observation on your progress."})]}),(0,s.jsxs)(L,{className:"min-h-[100px]",children:[a&&(0,s.jsxs)("div",{className:"flex items-center justify-center p-4",children:[(0,s.jsx)(ep.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-2",children:"Analyzing your stats..."})]}),i&&!a&&(0,s.jsxs)("div",{className:"flex items-center text-destructive p-4 bg-destructive/10 rounded-md",children:[(0,s.jsx)(ey.A,{className:"h-5 w-5 mr-2 shrink-0"}),(0,s.jsx)("p",{className:"text-sm",children:i})]}),e&&!a&&!i&&(0,s.jsx)("p",{className:"text-foreground leading-relaxed text-sm",children:e}),!a&&!i&&!e&&o&&u.length>0&&(0,s.jsx)("p",{className:"text-muted-foreground text-sm",children:"Click the button to generate an AI insight on your stats."}),!o&&u.length>0&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:"Set your Gemini API key in settings to enable AI insights."}),o&&0===u.length&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Add and track some habits to get insights."}),o&&u.length>0&&(0,s.jsxs)(d,{onClick:f,disabled:a||!h,className:"mt-4",variant:"outline",size:"sm",children:[a?(0,s.jsx)(ep.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(e3.A,{className:"mr-2 h-4 w-4"}),e?"Refresh Insight":"Get Insight"]})]})]}):null}let e7=["hsl(var(--chart-1))","hsl(var(--chart-2))","hsl(var(--chart-3))","hsl(var(--chart-4))","hsl(var(--chart-5))"];function te(){let{habits:e,getStreak:t}=(0,P.L)(),a=(0,r.useMemo)(()=>e.filter(e=>!e.archived),[e]),n=(0,r.useMemo)(()=>{if(0===a.length)return[];let e=new Date,t=(0,e2.e)(e,29);return(0,e5.k)({start:t,end:e}).map(e=>{let t=(0,er.GP)(e,"yyyy-MM-dd"),s=0;return a.forEach(e=>{e.progress[t]&&s++}),{date:(0,er.GP)(e,"MMM d"),"Completion Rate":a.length>0?s/a.length*100:0,Completed:s}})},[a]),i=(0,r.useMemo)(()=>a.map((e,t)=>{let a=Object.keys(e.progress).map(e=>(0,en.H)(e));if(0===a.length)return{name:e.name,value:0,fill:e.color||e7[t%e7.length]};let s=new Date(Math.min(...a.map(e=>e.getTime()))),r=new Date(Math.max(...a.map(e=>e.getTime()),new Date().getTime())),n=(0,e5.k)({start:s,end:r}).length,i=Object.values(e.progress).filter(Boolean).length;return{name:e.name,value:n>0?parseFloat((i/n*100).toFixed(1)):0,fill:e.color||e7[t%e7.length]}}).sort((e,t)=>t.value-e.value),[a]),l=(0,r.useMemo)(()=>{if(0===a.length)return null;let e=(0,er.GP)((0,e2.e)(new Date,1),"yyyy-MM-dd"),s=a.filter(t=>t.progress[e]).length,r=a.length;return{completionRate:r>0?s/r*100:0,totalHabits:r,habitsCompleted:s,longestStreak:Math.max(0,...a.map(e=>t(e.id)))}},[a,t]);if(0===a.length)return(0,s.jsxs)(H,{className:"glass-card mt-8",children:[(0,s.jsxs)(M,{children:[(0,s.jsxs)(O,{className:"font-headline text-xl flex items-center",children:[(0,s.jsx)(eT.A,{className:"mr-2 h-5 w-5 text-primary"}),"Your Statistics"]}),(0,s.jsx)(_,{children:"Track some habits to see your progress here."})]}),(0,s.jsx)(L,{children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No data to display yet. Add some habits and mark their progress!"})})]});let o={"Completion Rate":{label:"Completion Rate (%)",color:"hsl(var(--chart-1))"},Completed:{label:"Habits Completed",color:"hsl(var(--chart-2))"},...i.reduce((e,t)=>({...e,[t.name]:{label:t.name,color:t.fill}}),{})};return(0,s.jsxs)("div",{className:"grid gap-6 mt-8 md:grid-cols-1 lg:grid-cols-2",children:[(0,s.jsxs)(H,{className:"glass-card",children:[(0,s.jsxs)(M,{children:[(0,s.jsxs)(O,{className:"font-headline text-xl flex items-center",children:[(0,s.jsx)(eD.A,{className:"mr-2 h-5 w-5 text-primary"}),"Overall Completion (Last 30 Days)"]}),(0,s.jsx)(_,{children:"Your daily habit completion rate."})]}),(0,s.jsx)(L,{children:(0,s.jsx)(eF,{config:o,className:"h-[300px] w-full",children:(0,s.jsxs)(eV.Q,{data:n,margin:{top:5,right:20,left:-20,bottom:5},children:[(0,s.jsx)(eZ.d,{strokeDasharray:"3 3",vertical:!1}),(0,s.jsx)(eQ.W,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,fontSize:12}),(0,s.jsx)(eX.h,{unit:"%",tickLine:!1,axisLine:!1,tickMargin:8,fontSize:12,domain:[0,100]}),(0,s.jsx)(eK,{cursor:!1,content:(0,s.jsx)(eU,{indicator:"line"})}),(0,s.jsx)(eW.G,{type:"monotone",dataKey:"Completion Rate",stroke:"var(--color-Completion Rate)",fill:"var(--color-Completion Rate)",fillOpacity:.3,dot:!1})]})})})]}),(0,s.jsxs)(H,{className:"glass-card",children:[(0,s.jsxs)(M,{children:[(0,s.jsxs)(O,{className:"font-headline text-xl flex items-center",children:[(0,s.jsx)(eH.A,{className:"mr-2 h-5 w-5 text-primary"}),"Habit Success Rates"]}),(0,s.jsx)(_,{children:"Overall success rate for each active habit since tracking began or last 30 days."})]}),(0,s.jsx)(L,{children:(0,s.jsx)(eF,{config:o,className:"h-[300px] w-full",children:(0,s.jsxs)(e$.r,{children:[(0,s.jsx)(eK,{content:(0,s.jsx)(eU,{hideLabel:!0,nameKey:"name"})}),(0,s.jsx)(e0.F,{data:i,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:100,labelLine:!1,label:e=>{let{cx:t,cy:a,midAngle:r,innerRadius:n,outerRadius:i,percent:l,index:o}=e,d=Math.PI/180,c=n+(i-n)*.5,m=t+c*Math.cos(-r*d),u=a+c*Math.sin(-r*d);return 0===l?null:(0,s.jsx)("text",{x:m,y:u,fill:"white",textAnchor:m>t?"start":"end",dominantBaseline:"central",fontSize:12,children:"".concat((100*l).toFixed(0),"%")})},children:i.map((e,t)=>(0,s.jsx)(e1.f,{fill:e.fill},"cell-".concat(t)))}),(0,s.jsx)(eJ,{content:(0,s.jsx)(eq,{nameKey:"name"})})]})})})]}),l&&(0,s.jsxs)(H,{className:"glass-card",children:[" ",(0,s.jsx)(M,{children:(0,s.jsx)(O,{className:"font-headline text-xl",children:"Yesterday's Snapshot"})}),(0,s.jsxs)(L,{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 text-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"text-2xl font-bold",children:[l.completionRate.toFixed(0),"%"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Completion"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold",children:l.habitsCompleted}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Habits Done"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold",children:l.totalHabits}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Habits"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold",children:l.longestStreak}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Longest Streak"})]})]})]}),(0,s.jsx)(e9,{})," "]})}function tt(){let[e,t]=(0,r.useState)(null),[a,n]=(0,r.useState)(!1),[i,l]=(0,r.useState)(null),{isApiKeySet:o}=(0,ev.R)(),{habits:c}=(0,P.L)(),{toast:m}=(0,R.dj)(),u=c.filter(e=>!e.archived),h=async()=>{if(!o){m({title:"API Key Required",description:"Please set your Gemini API key to get AI summaries.",variant:"destructive"});return}if(0===u.length){m({title:"No Active Habits",description:"Track some habits to get a daily summary."});return}n(!0),l(null),t(null);try{var e;let a=(0,e2.e)(new Date,1),s=(0,er.GP)(a,"yyyy-MM-dd"),r=u.filter(e=>e.progress[s]).length,n=u.length,i=Math.max(0,...u.map(e=>{let t=0,a=new Date;for(;;){let s=(0,er.GP)(a,"yyyy-MM-dd");if(e.progress[s])t++,a=(0,e2.e)(a,1);else break}return t})),l=(e={completionRate:parseFloat((n>0?r/n*100:0).toFixed(1)),totalHabits:n,habitsCompleted:r,longestStreak:i},"Yesterday, you completed ".concat(e.habitsCompleted," out of ").concat(e.totalHabits," habits, resulting in a completion rate of ").concat(e.completionRate,"%. Your longest streak is ").concat(e.longestStreak," days.\n\nProvide a single-sentence summary of this information, highlighting the most relevant information to motivate the user. Focus on positive achievements and potential areas for improvement. The output should be a single sentence of text only.")),o=await ew(l);t(o)}catch(t){console.error("Error fetching daily summary:",t);let e=t.message||"Failed to generate summary. Please check your API key and try again.";l(e),m({title:"AI Error",description:e,variant:"destructive"})}finally{n(!1)}};return(0,r.useEffect)(()=>{o&&u.length},[o,u.length]),(0,s.jsxs)(H,{className:"my-8 glass-card",children:[(0,s.jsxs)(M,{children:[(0,s.jsxs)(O,{className:"font-headline text-xl flex items-center",children:[(0,s.jsx)(eb.A,{className:"mr-2 h-5 w-5 text-primary"}),"AI Daily Micro-Summary"]}),(0,s.jsx)(_,{children:"A quick AI-powered recap of yesterday's habit performance."})]}),(0,s.jsxs)(L,{children:[a&&(0,s.jsxs)("div",{className:"flex items-center justify-center p-4",children:[(0,s.jsx)(ep.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-2",children:"Generating summary..."})]}),i&&!a&&(0,s.jsxs)("div",{className:"flex items-center text-destructive p-4 bg-destructive/10 rounded-md",children:[(0,s.jsx)(ey.A,{className:"h-5 w-5 mr-2"}),(0,s.jsx)("p",{children:i})]}),e&&!a&&!i&&(0,s.jsx)("p",{className:"text-foreground leading-relaxed",children:e}),!e&&!a&&!i&&o&&u.length>0&&(0,s.jsx)("p",{className:"text-muted-foreground",children:"Click the button to generate your daily summary."}),!o&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:"Set your Gemini API key in settings to enable AI summaries."}),o&&0===u.length&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Add some habits to get a daily summary."}),(0,s.jsxs)(d,{onClick:h,disabled:a||!o||0===u.length,className:"mt-4",children:[a?(0,s.jsx)(ep.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(eb.A,{className:"mr-2 h-4 w-4"}),e?"Refresh Summary":"Get Today's Summary"]})]})]})}var ta=a(30990),ts=a(98328),tr=a(85268),tn=a(29532);let ti=h.Ik({challengeTitle:h.Yj().describe("A short, catchy title for the habit challenge (max 10 words). Example: 'The 7-Day Hydration Hero Quest'"),challengeDescription:h.Yj().describe("An engaging description of the challenge, outlining its goals and rules (2-3 sentences). Example: 'Embark on a legendary journey to drink 8 glasses of water daily for 7 days! Track your progress and emerge a hydration champion.'"),durationDays:h.ai().int().min(3).max(30).describe("The recommended duration of the challenge in days (choose from 7, 14, 21, or 30). Example: 7"),rewardSuggestion:h.Yj().describe("A creative and motivating non-monetary reward suggestion for completing the challenge (max 15 words). Example: 'Unlock an evening of your favorite guilt-free entertainment!'")});function tl(){let[e,t]=(0,r.useState)(null),[a,n]=(0,r.useState)(!1),[i,l]=(0,r.useState)(null),{isApiKeySet:o}=(0,ev.R)(),{habits:c,addHabit:m}=(0,P.L)(),{toast:u}=(0,R.dj)(),h=c.filter(e=>!e.archived),f=o&&h.length>0,g=async()=>{if(!o){u({title:"API Key Required",description:"Please set your Gemini API key to generate challenges.",variant:"destructive"});return}if(0===h.length){u({title:"No Active Habits",description:"Add some habits before generating a challenge."});return}n(!0),l(null);try{let e;let a=h.map(e=>e.name),s=function(e){let t=e.trackedHabits.length>0?e.trackedHabits.map(e=>"- ".concat(e)).join("\n"):"- General well-being and self-improvement.";return'You are a master game designer AI, specializing in creating motivating and fun "Habit Quests" (gamified challenges) for users trying to build positive habits.\n\nThe user is currently tracking these habits:\n'.concat(t,'\n\nYour task is to design a new Habit Quest. The quest should be:\n- Thematic and Engaging: Give it a fun theme (e.g., adventurer, explorer, wizard, scientist, athlete).\n- Supportive: It should ideally support one or more of the user\'s existing habits, or introduce a related micro-habit.\n- Achievable: The goals should be clear and feel attainable.\n- Motivating: Make it sound exciting!\n\nOutput ONLY a valid JSON object in the following format, adhering to the descriptions. Do NOT include any other text or markdown formatting like ```json:\n{\n  "challengeTitle": "string",\n  "challengeDescription": "string",\n  "durationDays": "number",\n  "rewardSuggestion": "string"\n}\n\nExample "challengeTitle": "The 7-Day Hydration Hero Quest"\nExample "challengeDescription": "Embark on a legendary journey to drink 8 glasses of water daily for 7 days! Track your progress and emerge a hydration champion."\nExample "durationDays": 7 (must be one of 7, 14, 21, or 30)\nExample "rewardSuggestion": "Unlock an evening of your favorite guilt-free entertainment!"\n\nEnsure \'durationDays\' is one of 7, 14, 21, or 30.\nThe theme should be subtle and integrated into the title and description.\nIf no habits are provided, create a general well-being quest.')}({trackedHabits:a}),r=await ew(s);try{e=JSON.parse(r)}catch(e){throw console.error("Failed to parse JSON response from AI:",e,"Raw response:",r),Error("AI returned an invalid format. Please try again.")}let n=ti.safeParse(e);if(!n.success)throw console.error("Zod validation failed:",n.error.errors,"Parsed data:",e),Error("AI returned data in an unexpected structure.");t(n.data),u({title:"Challenge Generated!",description:"Your new quest: ".concat(n.data.challengeTitle)})}catch(t){console.error("Error generating gamified challenge:",t);let e=t.message||"Failed to generate challenge. Please check your API key and try again.";l(e),u({title:"AI Error",description:e,variant:"destructive"})}finally{n(!1)}};return(0,s.jsxs)(H,{className:"mt-12 glass-card",children:[(0,s.jsxs)(M,{children:[(0,s.jsxs)(O,{className:"font-headline text-xl flex items-center",children:[(0,s.jsx)(ta.A,{className:"mr-2 h-5 w-5 text-primary"}),"AI Gamified Challenge"]}),(0,s.jsx)(_,{children:"Spice up your routine with a fun, AI-generated challenge!"})]}),(0,s.jsxs)(L,{className:"space-y-4 min-h-[150px]",children:[a&&(0,s.jsxs)("div",{className:"flex items-center justify-center p-4",children:[(0,s.jsx)(ep.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-2",children:"Forging your epic quest..."})]}),i&&!a&&(0,s.jsxs)("div",{className:"flex items-center text-destructive p-4 bg-destructive/10 rounded-md",children:[(0,s.jsx)(ey.A,{className:"h-5 w-5 mr-2 shrink-0"}),(0,s.jsx)("p",{children:i})]}),e&&!a&&!i&&(0,s.jsxs)("div",{className:"space-y-3 p-4 border border-border rounded-lg bg-background/30 dark:bg-background/20 shadow-sm",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-primary flex items-center",children:[(0,s.jsx)(eb.A,{className:"mr-2 h-5 w-5"})," ",e.challengeTitle]}),(0,s.jsx)("p",{className:"text-sm text-foreground/90",children:e.challengeDescription}),(0,s.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,s.jsx)(ts.A,{className:"mr-2 h-4 w-4"}),"Duration: ",e.durationDays," day",1!==e.durationDays?"s":""]}),(0,s.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,s.jsx)(tr.A,{className:"mr-2 h-4 w-4"}),"Reward Suggestion: ",e.rewardSuggestion]}),(0,s.jsxs)(d,{onClick:()=>{if(!e)return;let t=e.challengeTitle;m({name:t,description:"".concat(e.challengeDescription," This is a ").concat(e.durationDays,"-day challenge. Suggested reward: ").concat(e.rewardSuggestion)}),u({title:"Challenge Added as Habit!",description:'"'.concat(t,'" is now in your habit list.')})},variant:"outline",size:"sm",className:"mt-3",children:[(0,s.jsx)(tn.A,{className:"mr-2 h-4 w-4"}),"Add as Habit"]})]}),!e&&!a&&!i&&!o&&(0,s.jsx)("p",{className:"text-sm text-destructive text-center p-4",children:"Set your Gemini API key in settings to enable AI-powered challenges."}),!e&&!a&&!i&&o&&0===h.length&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground text-center p-4",children:"Add some habits first to get personalized challenges."}),!e&&!a&&!i&&o&&h.length>0&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground text-center p-4",children:"Ready for a new adventure? Click the button below!"})]}),(0,s.jsx)(G,{children:(0,s.jsxs)(d,{onClick:g,disabled:a||!f,className:"w-full sm:w-auto",children:[a?(0,s.jsx)(ep.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(ta.A,{className:"mr-2 h-4 w-4"}),e?"Generate New Challenge":"Generate Challenge"]})})]})}var to=a(60704);let td=to.bL,tc=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(to.B8,{ref:t,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...r})});tc.displayName=to.B8.displayName;let tm=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(to.l9,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...r})});tm.displayName=to.l9.displayName;let tu=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(to.UC,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})});function th(){let[e,t]=(0,r.useState)(!1);return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsx)(eR,{}),(0,s.jsx)(tt,{}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[(0,s.jsx)("h2",{className:"font-headline text-3xl font-semibold tracking-tight",children:"Your Habits"}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsxs)(d,{onClick:()=>t(!0),children:[(0,s.jsx)(c.A,{className:"mr-2 h-4 w-4"})," Add Habit"]})})]}),(0,s.jsxs)(td,{defaultValue:"active",className:"w-full",children:[(0,s.jsxs)(tc,{className:"grid w-full grid-cols-2 sm:w-[300px] mb-4",children:[(0,s.jsx)(tm,{value:"active",children:"Active Habits"}),(0,s.jsx)(tm,{value:"archived",children:"Archived"})]}),(0,s.jsx)(tu,{value:"active",children:(0,s.jsx)(eS,{showArchived:!1})}),(0,s.jsx)(tu,{value:"archived",children:(0,s.jsx)(eS,{showArchived:!0})})]})]}),(0,s.jsx)(te,{}),(0,s.jsx)(D,{isOpen:e,setIsOpen:t}),(0,s.jsx)(tl,{})]})}tu.displayName=to.UC.displayName;var tf=a(36936),tg=a(68027),tx=a(77724),tp=a(93576),ty=a(76570),tb=a(28044);function tv(e){let{isOpen:t,setIsOpen:a}=e,{apiKey:n,setApiKey:i,isApiKeySet:l}=(0,ev.R)(),[o,c]=(0,r.useState)(""),{toast:m}=(0,R.dj)();return(0,r.useEffect)(()=>{n?c(n):c("")},[n,t]),(0,s.jsx)(j,{open:t,onOpenChange:a,children:(0,s.jsxs)(A,{className:"sm:max-w-[480px] glass-card",children:[(0,s.jsxs)(C,{children:[(0,s.jsx)(S,{className:"font-headline text-2xl",children:"Gemini API Key"}),(0,s.jsx)(E,{children:"Enter your Gemini API key to enable AI-powered features. Your key is stored locally in your browser."})]}),(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,s.jsx)(y,{htmlFor:"apiKey",className:"text-right",children:"API Key"}),(0,s.jsx)(f,{id:"apiKey",type:"password",value:o,onChange:e=>c(e.target.value),className:"col-span-3",placeholder:"Enter your Gemini API Key"})]}),l&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-green-600 dark:text-green-400 col-span-4 justify-center",children:[(0,s.jsx)(ty.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"API Key is set."})]})]}),(0,s.jsxs)(I,{className:"gap-2 sm:justify-between",children:[l&&(0,s.jsx)(d,{type:"button",variant:"destructive",onClick:()=>{i(null),c(""),m({title:"API Key Removed",description:"Your Gemini API key has been removed from local storage.",variant:"destructive",action:(0,s.jsx)(tb.A,{className:"h-5 w-5 text-yellow-500"})})},children:"Remove Key"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(w,{asChild:!0,children:(0,s.jsx)(d,{type:"button",variant:"outline",children:"Cancel"})}),(0,s.jsx)(d,{type:"submit",onClick:()=>{i(o),m({title:"API Key Saved",description:"Your Gemini API key has been saved locally.",action:(0,s.jsx)(ty.A,{className:"h-5 w-5 text-green-500"})}),a(!1)},disabled:!o.trim(),children:"Save Key"})]})]})]})})}var tj=a(52612),tN=a(6874),tw=a.n(tN);function tk(){let[e,t]=r.useState(!1),{theme:a,setTheme:n,resolvedTheme:i}=(0,tj.D)(),l="dark"===i?tf.A:tg.A;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("header",{className:"sticky top-0 z-50 w-full border-b border-border/60 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,s.jsxs)("div",{className:"container flex h-16 max-w-screen-2xl items-center justify-between px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)(tw(),{href:"/",className:"flex items-center space-x-2",children:[(0,s.jsx)(tx.A,{className:"h-7 w-7 text-primary"}),(0,s.jsx)("span",{className:"font-headline text-xl font-bold tracking-tight",children:"HabitLocal"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(d,{variant:"ghost",size:"icon",onClick:()=>{"dark"===i?n("light"):n("dark")},"aria-label":"Toggle theme",children:(0,s.jsx)(l,{className:"h-5 w-5"})}),(0,s.jsx)(d,{variant:"ghost",size:"icon",onClick:()=>t(!0),"aria-label":"API Key Settings",children:(0,s.jsx)(tp.A,{className:"h-5 w-5"})})]})]})}),(0,s.jsx)(tv,{isOpen:e,setIsOpen:t})]})}function tA(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tk,{}),(0,s.jsx)("main",{className:"flex-grow container mx-auto px-4 py-8 sm:px-6 lg:px-8",children:(0,s.jsx)(th,{})}),(0,s.jsx)("footer",{className:"py-6 text-center text-xs text-muted-foreground",children:"HabitLocal - Your AI Powered Habit Companion"})]})}},70115:(e,t,a)=>{"use strict";a.d(t,{M:()=>r});var s=a(12115);function r(e,t){let a=()=>{try{let a=window.localStorage.getItem(e);return a?JSON.parse(a):t}catch(a){return console.warn("Error reading localStorage key ".concat(e,":"),a),t}},[r,n]=(0,s.useState)(a);return(0,s.useEffect)(()=>{n(a())},[]),(0,s.useEffect)(()=>{let t=t=>{(t.key===e||null===t.key)&&n(a())},s=()=>{n(a())};return window.addEventListener("storage",t),window.addEventListener("local-storage",s),()=>{window.removeEventListener("storage",t),window.removeEventListener("local-storage",s)}},[]),[r,t=>{try{let a=t instanceof Function?t(r):t;window.localStorage.setItem(e,JSON.stringify(a)),n(a),window.dispatchEvent(new Event("local-storage"))}catch(t){console.warn("Error setting localStorage key ".concat(e,":"),t)}}]}},87481:(e,t,a)=>{"use strict";a.d(t,{dj:()=>u});var s=a(12115);let r=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],d={toasts:[]};function c(e){d=l(d,e),o.forEach(e=>{e(d)})}function m(e){let{...t}=e,a=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function u(){let[e,t]=s.useState(d);return s.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}}},e=>{var t=t=>e(e.s=t);e.O(0,[798,882,46,441,684,358],()=>t(32751)),_N_E=e.O()}]);